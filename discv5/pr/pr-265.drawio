<mxfile host="65bd71144e">
    <diagram id="ExdccTZqctQwAvQB16s_" name="Page-1">
        <mxGraphModel dx="3226" dy="2012" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="0" pageScale="1" pageWidth="827" pageHeight="1169" background="none" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="103" value="Node A" style="rounded=0;whiteSpace=wrap;html=1;fontSize=14;fontStyle=1" vertex="1" parent="1">
                    <mxGeometry x="40" y="-280" width="160" height="41" as="geometry"/>
                </mxCell>
                <mxCell id="104" value="Node B" style="rounded=0;whiteSpace=wrap;html=1;fontSize=14;fontStyle=1" vertex="1" parent="1">
                    <mxGeometry x="395" y="-278" width="160" height="39" as="geometry"/>
                </mxCell>
                <mxCell id="106" value="" style="endArrow=none;dashed=1;html=1;fontSize=12;entryX=0.5;entryY=1;entryDx=0;entryDy=0;startArrow=none;" edge="1" parent="1" target="103" source="169">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="120" y="1850" as="sourcePoint"/>
                        <mxPoint x="570" y="240" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="107" value="" style="endArrow=none;dashed=1;html=1;fontSize=12;entryX=0.5;entryY=1;entryDx=0;entryDy=0;startArrow=none;" edge="1" parent="1" target="104" source="180">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="480" y="1920" as="sourcePoint"/>
                        <mxPoint x="560" y="181" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="147" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;fontSize=14;fontColor=#F7FF19;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=1;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="178" target="196">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="900" y="260" as="sourcePoint"/>
                        <mxPoint x="980" y="60" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="149" value="" style="shape=cross;whiteSpace=wrap;html=1;fontSize=12;rotation=45;fillColor=#E31E4C;fontColor=#000000;strokeColor=#B09500;" vertex="1" parent="1">
                    <mxGeometry x="175.14" y="855" width="30" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="170" value="" style="endArrow=none;dashed=1;html=1;fontSize=12;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" target="169">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="120" y="1850" as="sourcePoint"/>
                        <mxPoint x="120" y="41" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="169" value="&lt;b&gt;Change IP&lt;br&gt;from: 16.1.0.2&lt;br&gt;to: 16.1.0.5&lt;br&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="60" y="-40" width="120" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="171" value="" style="endArrow=classic;html=1;fontSize=18;" edge="1" parent="1">
                    <mxGeometry x="-160" y="-230" width="50" height="50" as="geometry">
                        <mxPoint x="120" y="70" as="sourcePoint"/>
                        <mxPoint x="480" y="70" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="172" value="PING" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=14;" vertex="1" connectable="0" parent="171">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="-140" y="-10" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="173" value="" style="endArrow=classic;html=1;fontSize=18;" edge="1" parent="1">
                    <mxGeometry x="-150" y="-220" width="50" height="50" as="geometry">
                        <mxPoint x="480" y="190" as="sourcePoint"/>
                        <mxPoint x="120" y="190" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="174" value="WHOAREYOU" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=14;" vertex="1" connectable="0" parent="173">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="120" y="-10" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="175" value="Received a message without session" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="360" y="110" width="220" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="176" value="" style="endArrow=classic;html=1;fontSize=18;" edge="1" parent="1">
                    <mxGeometry x="-160" y="-70" width="50" height="50" as="geometry">
                        <mxPoint x="120" y="230" as="sourcePoint"/>
                        <mxPoint x="480" y="230" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="177" value="Auth message" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=14;" vertex="1" connectable="0" parent="176">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="-120" y="-10" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="178" value="Session has invalid ENR&lt;br&gt;&lt;br&gt;enr.upp4_socket: 16.1.0.2&lt;br&gt;src: 16.1.0.5" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="370" y="250" width="220" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="181" value="" style="endArrow=none;dashed=1;html=1;fontSize=12;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" target="180">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="480" y="1920" as="sourcePoint"/>
                        <mxPoint x="480" y="41" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="180" value="Handle PING" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="405" y="350" width="150" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="182" value="" style="endArrow=classic;html=1;fontSize=18;" edge="1" parent="1">
                    <mxGeometry x="-150" y="20" width="50" height="50" as="geometry">
                        <mxPoint x="480" y="430" as="sourcePoint"/>
                        <mxPoint x="120" y="430" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="183" value="PONG" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=14;" vertex="1" connectable="0" parent="182">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="120" y="-10" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="184" value="&lt;b&gt;Update ENR&lt;br&gt;udp4_socket: 16.1.0.2 -&amp;gt; 16.1.0.5&lt;br&gt;seq: 1 -&amp;gt; 2&lt;br&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="-20" y="470" width="250" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="185" value="" style="endArrow=classic;html=1;fontSize=18;" edge="1" parent="1">
                    <mxGeometry x="-160" y="288" width="50" height="50" as="geometry">
                        <mxPoint x="120" y="588" as="sourcePoint"/>
                        <mxPoint x="480" y="588" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="186" value="PING&amp;nbsp; (seq: 2)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=14;" vertex="1" connectable="0" parent="185">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="-120" y="-10" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="187" value="Handle PING" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="405" y="630" width="150" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="188" value="" style="endArrow=classic;html=1;fontSize=18;" edge="1" parent="1">
                    <mxGeometry x="-150" y="300" width="50" height="50" as="geometry">
                        <mxPoint x="480" y="710" as="sourcePoint"/>
                        <mxPoint x="120" y="710" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="189" value="PONG" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=14;" vertex="1" connectable="0" parent="188">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="120" y="-10" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="190" value="Also, since the seq is increased to 2,&lt;br&gt;the Service requests Node A's ENR by sending FINDNODE.&lt;br&gt;( `Service::handle_rpc_request()` )" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="292.5" y="750" width="375" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="191" value="" style="endArrow=classic;html=1;fontSize=18;" edge="1" parent="1">
                    <mxGeometry x="-150" y="460" width="50" height="50" as="geometry">
                        <mxPoint x="480" y="870" as="sourcePoint"/>
                        <mxPoint x="200" y="870" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="192" value="FINDNODE (distance: [0])" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=14;" vertex="1" connectable="0" parent="191">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="50" y="-10" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="193" value="This FINDNODE request timed out &lt;br&gt;because the destination IP is &lt;b&gt;&lt;font color=&quot;#ff3333&quot;&gt;16.1.0.2&lt;/font&gt;&lt;/b&gt;, &lt;br&gt;which is the IP stored in the routing table." style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;" vertex="1" parent="1">
                    <mxGeometry x="280" y="890" width="285" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="194" value="Session eslablished with Node A" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="375" y="-160" width="220" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="195" value="Session eslablished with Node B" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="10" y="-160" width="220" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="196" value="A new session with 16.1.0.5 has been established.&lt;br&gt;&lt;br&gt;The routing table hasn’t been updated with the ENR&lt;br&gt;since the IPs don't match." style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;" vertex="1" parent="1">
                    <mxGeometry x="640" y="150" width="350" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="198" value="We should avoid sending FINDNODE if the src IP and the IP in the routing table don't match?" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fontStyle=1" vertex="1" parent="1">
                    <mxGeometry x="380" y="980" width="325" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="199" value="PING to notify the connected peers that the ENR has been updated." style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;" vertex="1" parent="1">
                    <mxGeometry x="-130" y="560" width="230" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="200" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;flipH=1;labelPosition=right;verticalLabelPosition=middle;align=left;verticalAlign=middle;fontColor=#FF3333;" vertex="1" parent="1">
                    <mxGeometry x="675" y="575" width="104" height="312" as="geometry"/>
                </mxCell>
                <mxCell id="201" value="This is repeated each time Node A sends a PING." style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;" vertex="1" parent="1">
                    <mxGeometry x="777" y="679" width="321" height="94" as="geometry"/>
                </mxCell>
                <mxCell id="202" value="From the PONG response, Node A noticed that its IP had changed." style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;" vertex="1" parent="1">
                    <mxGeometry x="-142" y="355" width="242" height="102" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>