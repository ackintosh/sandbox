<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="666px" preserveAspectRatio="none" style="width:772px;height:666px;" version="1.1" viewBox="0 0 772 666" width="772px" zoomAndPan="magnify"><defs><filter height="300%" id="f18j3y4y5m4sge" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[91221848cc6fc2b51471cfb300e81a0a]
class Query--><rect codeLine="1" fill="#FEFECE" filter="url(#f18j3y4y5m4sge)" height="86.4141" id="Query" style="stroke: #A80036; stroke-width: 1.5;" width="151" x="18" y="13.5"/><ellipse cx="70.75" cy="29.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M73.0938,25.1719 C72.1563,24.7344 71.5625,24.5938 70.6875,24.5938 C68.0625,24.5938 66.0625,26.6719 66.0625,29.3906 L66.0625,30.5156 C66.0625,33.0938 68.1719,34.9844 71.0625,34.9844 C72.2813,34.9844 73.4375,34.6875 74.1875,34.1406 C74.7656,33.7344 75.0938,33.2813 75.0938,32.8906 C75.0938,32.4375 74.7031,32.0469 74.2344,32.0469 C74.0156,32.0469 73.8125,32.125 73.625,32.3125 C73.1719,32.7969 73.1719,32.7969 72.9844,32.8906 C72.5625,33.1563 71.875,33.2813 71.1094,33.2813 C69.0625,33.2813 67.7656,32.1875 67.7656,30.4844 L67.7656,29.3906 C67.7656,27.6094 69.0156,26.2969 70.75,26.2969 C71.3281,26.2969 71.9375,26.4531 72.4063,26.7031 C72.8906,26.9844 73.0625,27.2031 73.1563,27.6094 C73.2188,28.0156 73.25,28.1406 73.3906,28.2656 C73.5313,28.4063 73.7656,28.5156 73.9844,28.5156 C74.25,28.5156 74.5156,28.375 74.6875,28.1563 C74.7969,28 74.8281,27.8125 74.8281,27.3906 L74.8281,25.9688 C74.8281,25.5313 74.8125,25.4063 74.7188,25.25 C74.5625,24.9844 74.2813,24.8438 73.9844,24.8438 C73.6875,24.8438 73.4844,24.9375 73.2656,25.25 L73.0938,25.1719 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="37" x="91.25" y="33.6543">Query</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="19" x2="168" y1="45.5" y2="45.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="62" x="24" y="59.7104">id: QueryId</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="139" x="24" y="72.5151">peer_iter: QueryPeerIter</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="19" x2="168" y1="79.1094" y2="79.1094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="107" x="24" y="93.3198">next(): QueryState</text><!--MD5=[84aa077b81028f77e681b2c7b9eb53c7]
class QueryPeerIter--><rect codeLine="9" fill="#FEFECE" filter="url(#f18j3y4y5m4sge)" height="73.6094" id="QueryPeerIter" style="stroke: #A80036; stroke-width: 1.5;" width="173" x="7" y="198"/><ellipse cx="47.65" cy="214" fill="#EB937F" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M46.4469,214.875 L47.9,214.875 L47.9,214.9844 C47.9,215.3906 47.9313,215.5469 48.0094,215.7031 C48.1656,215.9531 48.4469,216.1094 48.7438,216.1094 C48.9938,216.1094 49.2594,215.9688 49.4156,215.75 C49.5406,215.5938 49.5719,215.4375 49.5719,214.9844 L49.5719,213.0625 C49.5719,212.9063 49.5719,212.8594 49.5563,212.7031 C49.4938,212.2344 49.1813,211.9219 48.7281,211.9219 C48.4781,211.9219 48.2125,212.0625 48.0406,212.2813 C47.9313,212.4531 47.9,212.6094 47.9,213.0625 L47.9,213.1875 L46.4469,213.1875 L46.4469,210.7813 L50.4313,210.7813 L50.4313,211.6406 C50.4313,212.0469 50.4625,212.2188 50.5406,212.375 C50.7125,212.625 50.9938,212.7813 51.275,212.7813 C51.5406,212.7813 51.8063,212.6406 51.9781,212.4219 C52.0875,212.25 52.1188,212.1094 52.1188,211.6406 L52.1188,209.0938 L44.4938,209.0938 C44.0563,209.0938 43.9313,209.1094 43.775,209.2031 C43.525,209.3594 43.3688,209.6563 43.3688,209.9375 C43.3688,210.2188 43.5094,210.4688 43.7281,210.6406 C43.8844,210.75 44.0719,210.7813 44.4938,210.7813 L44.7438,210.7813 L44.7438,217.2969 L44.4938,217.2969 C44.0875,217.2969 43.9313,217.3125 43.775,217.4219 C43.525,217.5938 43.3688,217.8594 43.3688,218.1563 C43.3688,218.4219 43.5094,218.6719 43.7281,218.8281 C43.8688,218.9531 44.1031,219 44.4938,219 L52.4938,219 L52.4938,216.4219 C52.4938,215.9844 52.4625,215.8438 52.3844,215.6875 C52.2125,215.4375 51.9313,215.2813 51.65,215.2813 C51.3844,215.2813 51.1188,215.3906 50.9469,215.6406 C50.8375,215.7969 50.8063,215.9375 50.8063,216.4219 L50.8063,217.2969 L46.4469,217.2969 L46.4469,214.875 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="84" x="67.35" y="218.1543">QueryPeerIter</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="8" x2="179" y1="230" y2="230"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="8" x2="179" y1="238" y2="238"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="161" x="13" y="252.2104">FindNode ( FindNodeQuery )</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="161" x="13" y="265.0151">Predicate ( PredicateQuery )</text><!--MD5=[70462786ce9dd1ca221f4010219fbb09]
class FindNodeQuery--><rect codeLine="16" fill="#FEFECE" filter="url(#f18j3y4y5m4sge)" height="137.6328" id="FindNodeQuery" style="stroke: #A80036; stroke-width: 1.5;" width="292" x="215.5" y="166"/><ellipse cx="310.25" cy="182" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M312.5938,177.6719 C311.6563,177.2344 311.0625,177.0938 310.1875,177.0938 C307.5625,177.0938 305.5625,179.1719 305.5625,181.8906 L305.5625,183.0156 C305.5625,185.5938 307.6719,187.4844 310.5625,187.4844 C311.7813,187.4844 312.9375,187.1875 313.6875,186.6406 C314.2656,186.2344 314.5938,185.7813 314.5938,185.3906 C314.5938,184.9375 314.2031,184.5469 313.7344,184.5469 C313.5156,184.5469 313.3125,184.625 313.125,184.8125 C312.6719,185.2969 312.6719,185.2969 312.4844,185.3906 C312.0625,185.6563 311.375,185.7813 310.6094,185.7813 C308.5625,185.7813 307.2656,184.6875 307.2656,182.9844 L307.2656,181.8906 C307.2656,180.1094 308.5156,178.7969 310.25,178.7969 C310.8281,178.7969 311.4375,178.9531 311.9063,179.2031 C312.3906,179.4844 312.5625,179.7031 312.6563,180.1094 C312.7188,180.5156 312.75,180.6406 312.8906,180.7656 C313.0313,180.9063 313.2656,181.0156 313.4844,181.0156 C313.75,181.0156 314.0156,180.875 314.1875,180.6563 C314.2969,180.5 314.3281,180.3125 314.3281,179.8906 L314.3281,178.4688 C314.3281,178.0313 314.3125,177.9063 314.2188,177.75 C314.0625,177.4844 313.7813,177.3438 313.4844,177.3438 C313.1875,177.3438 312.9844,177.4375 312.7656,177.75 L312.5938,177.6719 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="94" x="330.75" y="186.1543">FindNodeQuery</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="216.5" x2="506.5" y1="198" y2="198"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="90" x="221.5" y="212.2104">target_key: Key</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="139" x="221.5" y="225.0151">progress: QueryProgress</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="280" x="221.5" y="237.8198">closest_peers: BTreeMap&lt;Distance, QueryPeer&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="91" x="221.5" y="250.6245">iterations: usize</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="109" x="221.5" y="263.4292">num_waiting: usize</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="165" x="221.5" y="276.2339">config: FindNodeQueryConfig</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="216.5" x2="506.5" y1="282.8281" y2="282.8281"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="107" x="221.5" y="297.0386">next(): QueryState</text><!--MD5=[7e0fb8fb83c2923aa8aa5a07ec1589e3]
class QueryProgress--><rect codeLine="32" fill="#FEFECE" filter="url(#f18j3y4y5m4sge)" height="86.4141" id="QueryProgress" style="stroke: #A80036; stroke-width: 1.5;" width="123" x="216" y="370.5"/><ellipse cx="231" cy="386.5" fill="#EB937F" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M229.7969,387.375 L231.25,387.375 L231.25,387.4844 C231.25,387.8906 231.2813,388.0469 231.3594,388.2031 C231.5156,388.4531 231.7969,388.6094 232.0938,388.6094 C232.3438,388.6094 232.6094,388.4688 232.7656,388.25 C232.8906,388.0938 232.9219,387.9375 232.9219,387.4844 L232.9219,385.5625 C232.9219,385.4063 232.9219,385.3594 232.9063,385.2031 C232.8438,384.7344 232.5313,384.4219 232.0781,384.4219 C231.8281,384.4219 231.5625,384.5625 231.3906,384.7813 C231.2813,384.9531 231.25,385.1094 231.25,385.5625 L231.25,385.6875 L229.7969,385.6875 L229.7969,383.2813 L233.7813,383.2813 L233.7813,384.1406 C233.7813,384.5469 233.8125,384.7188 233.8906,384.875 C234.0625,385.125 234.3438,385.2813 234.625,385.2813 C234.8906,385.2813 235.1563,385.1406 235.3281,384.9219 C235.4375,384.75 235.4688,384.6094 235.4688,384.1406 L235.4688,381.5938 L227.8438,381.5938 C227.4063,381.5938 227.2813,381.6094 227.125,381.7031 C226.875,381.8594 226.7188,382.1563 226.7188,382.4375 C226.7188,382.7188 226.8594,382.9688 227.0781,383.1406 C227.2344,383.25 227.4219,383.2813 227.8438,383.2813 L228.0938,383.2813 L228.0938,389.7969 L227.8438,389.7969 C227.4375,389.7969 227.2813,389.8125 227.125,389.9219 C226.875,390.0938 226.7188,390.3594 226.7188,390.6563 C226.7188,390.9219 226.8594,391.1719 227.0781,391.3281 C227.2188,391.4531 227.4531,391.5 227.8438,391.5 L235.8438,391.5 L235.8438,388.9219 C235.8438,388.4844 235.8125,388.3438 235.7344,388.1875 C235.5625,387.9375 235.2813,387.7813 235,387.7813 C234.7344,387.7813 234.4688,387.8906 234.2969,388.1406 C234.1875,388.2969 234.1563,388.4375 234.1563,388.9219 L234.1563,389.7969 L229.7969,389.7969 L229.7969,387.375 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="91" x="245" y="390.6543">QueryProgress</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="217" x2="338" y1="402.5" y2="402.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="222" y="416.7104">Iterating</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="40" x="222" y="429.5151">Stalled</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="222" y="442.3198">Finished</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="217" x2="338" y1="448.9141" y2="448.9141"/><!--MD5=[f1c3a563d6332dd73a6e737195f3eda9]
class QueryPeer--><rect codeLine="38" fill="#FEFECE" filter="url(#f18j3y4y5m4sge)" height="99.2188" id="QueryPeer" style="stroke: #A80036; stroke-width: 1.5;" width="140" x="374.5" y="364"/><ellipse cx="409.3" cy="380" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M411.6438,375.6719 C410.7063,375.2344 410.1125,375.0938 409.2375,375.0938 C406.6125,375.0938 404.6125,377.1719 404.6125,379.8906 L404.6125,381.0156 C404.6125,383.5938 406.7219,385.4844 409.6125,385.4844 C410.8313,385.4844 411.9875,385.1875 412.7375,384.6406 C413.3156,384.2344 413.6438,383.7813 413.6438,383.3906 C413.6438,382.9375 413.2531,382.5469 412.7844,382.5469 C412.5656,382.5469 412.3625,382.625 412.175,382.8125 C411.7219,383.2969 411.7219,383.2969 411.5344,383.3906 C411.1125,383.6563 410.425,383.7813 409.6594,383.7813 C407.6125,383.7813 406.3156,382.6875 406.3156,380.9844 L406.3156,379.8906 C406.3156,378.1094 407.5656,376.7969 409.3,376.7969 C409.8781,376.7969 410.4875,376.9531 410.9563,377.2031 C411.4406,377.4844 411.6125,377.7031 411.7063,378.1094 C411.7688,378.5156 411.8,378.6406 411.9406,378.7656 C412.0813,378.9063 412.3156,379.0156 412.5344,379.0156 C412.8,379.0156 413.0656,378.875 413.2375,378.6563 C413.3469,378.5 413.3781,378.3125 413.3781,377.8906 L413.3781,376.4688 C413.3781,376.0313 413.3625,375.9063 413.2688,375.75 C413.1125,375.4844 412.8313,375.3438 412.5344,375.3438 C412.2375,375.3438 412.0344,375.4375 411.8156,375.75 L411.6438,375.6719 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="64" x="427.7" y="384.1543">QueryPeer</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="375.5" x2="513.5" y1="396" y2="396"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="50" x="380.5" y="410.2104">key: Key</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="85" x="380.5" y="423.0151">iteration: usize</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="126" x="380.5" y="435.8198">peers_returned: usize</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="128" x="380.5" y="448.6245">state: QueryPeerState</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="375.5" x2="513.5" y1="455.2188" y2="455.2188"/><!--MD5=[00ab96f63a05f3a36d7ac76005be6a42]
class QueryPeerState--><rect codeLine="46" fill="#FEFECE" filter="url(#f18j3y4y5m4sge)" height="124.8281" id="QueryPeerState" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="381" y="523"/><ellipse cx="396" cy="539" fill="#EB937F" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M394.7969,539.875 L396.25,539.875 L396.25,539.9844 C396.25,540.3906 396.2813,540.5469 396.3594,540.7031 C396.5156,540.9531 396.7969,541.1094 397.0938,541.1094 C397.3438,541.1094 397.6094,540.9688 397.7656,540.75 C397.8906,540.5938 397.9219,540.4375 397.9219,539.9844 L397.9219,538.0625 C397.9219,537.9063 397.9219,537.8594 397.9063,537.7031 C397.8438,537.2344 397.5313,536.9219 397.0781,536.9219 C396.8281,536.9219 396.5625,537.0625 396.3906,537.2813 C396.2813,537.4531 396.25,537.6094 396.25,538.0625 L396.25,538.1875 L394.7969,538.1875 L394.7969,535.7813 L398.7813,535.7813 L398.7813,536.6406 C398.7813,537.0469 398.8125,537.2188 398.8906,537.375 C399.0625,537.625 399.3438,537.7813 399.625,537.7813 C399.8906,537.7813 400.1563,537.6406 400.3281,537.4219 C400.4375,537.25 400.4688,537.1094 400.4688,536.6406 L400.4688,534.0938 L392.8438,534.0938 C392.4063,534.0938 392.2813,534.1094 392.125,534.2031 C391.875,534.3594 391.7188,534.6563 391.7188,534.9375 C391.7188,535.2188 391.8594,535.4688 392.0781,535.6406 C392.2344,535.75 392.4219,535.7813 392.8438,535.7813 L393.0938,535.7813 L393.0938,542.2969 L392.8438,542.2969 C392.4375,542.2969 392.2813,542.3125 392.125,542.4219 C391.875,542.5938 391.7188,542.8594 391.7188,543.1563 C391.7188,543.4219 391.8594,543.6719 392.0781,543.8281 C392.2188,543.9531 392.4531,544 392.8438,544 L400.8438,544 L400.8438,541.4219 C400.8438,540.9844 400.8125,540.8438 400.7344,540.6875 C400.5625,540.4375 400.2813,540.2813 400,540.2813 C399.7344,540.2813 399.4688,540.3906 399.2969,540.6406 C399.1875,540.7969 399.1563,540.9375 399.1563,541.4219 L399.1563,542.2969 L394.7969,542.2969 L394.7969,539.875 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="95" x="410" y="543.1543">QueryPeerState</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="382" x2="507" y1="555" y2="555"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="77" x="387" y="569.2104">NotContacted</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="42" x="387" y="582.0151">Waiting</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="78" x="387" y="594.8198">Unresponsive</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="92" x="387" y="607.6245">PendingIteration</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="34" x="387" y="620.4292">Failed</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="65" x="387" y="633.2339">Succeeded</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="382" x2="507" y1="639.8281" y2="639.8281"/><!--MD5=[0fb1cc353160b37a35341f05664b2e83]
class QueryState--><rect codeLine="55" fill="#FEFECE" filter="url(#f18j3y4y5m4sge)" height="86.4141" id="QueryState" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="638" y="13.5"/><ellipse cx="659.75" cy="29.5" fill="#EB937F" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M658.5469,30.375 L660,30.375 L660,30.4844 C660,30.8906 660.0313,31.0469 660.1094,31.2031 C660.2656,31.4531 660.5469,31.6094 660.8438,31.6094 C661.0938,31.6094 661.3594,31.4688 661.5156,31.25 C661.6406,31.0938 661.6719,30.9375 661.6719,30.4844 L661.6719,28.5625 C661.6719,28.4063 661.6719,28.3594 661.6563,28.2031 C661.5938,27.7344 661.2813,27.4219 660.8281,27.4219 C660.5781,27.4219 660.3125,27.5625 660.1406,27.7813 C660.0313,27.9531 660,28.1094 660,28.5625 L660,28.6875 L658.5469,28.6875 L658.5469,26.2813 L662.5313,26.2813 L662.5313,27.1406 C662.5313,27.5469 662.5625,27.7188 662.6406,27.875 C662.8125,28.125 663.0938,28.2813 663.375,28.2813 C663.6406,28.2813 663.9063,28.1406 664.0781,27.9219 C664.1875,27.75 664.2188,27.6094 664.2188,27.1406 L664.2188,24.5938 L656.5938,24.5938 C656.1563,24.5938 656.0313,24.6094 655.875,24.7031 C655.625,24.8594 655.4688,25.1563 655.4688,25.4375 C655.4688,25.7188 655.6094,25.9688 655.8281,26.1406 C655.9844,26.25 656.1719,26.2813 656.5938,26.2813 L656.8438,26.2813 L656.8438,32.7969 L656.5938,32.7969 C656.1875,32.7969 656.0313,32.8125 655.875,32.9219 C655.625,33.0938 655.4688,33.3594 655.4688,33.6563 C655.4688,33.9219 655.6094,34.1719 655.8281,34.3281 C655.9688,34.4531 656.2031,34.5 656.5938,34.5 L664.5938,34.5 L664.5938,31.9219 C664.5938,31.4844 664.5625,31.3438 664.4844,31.1875 C664.3125,30.9375 664.0313,30.7813 663.75,30.7813 C663.4844,30.7813 663.2188,30.8906 663.0469,31.1406 C662.9375,31.2969 662.9063,31.4375 662.9063,31.9219 L662.9063,32.7969 L658.5469,32.7969 L658.5469,30.375 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="68" x="675.25" y="33.6543">QueryState</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="639" x2="752" y1="45.5" y2="45.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="42" x="644" y="59.7104">Waiting</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="103" x="644" y="72.5151">WaitingAtCapacity</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="644" y="85.3198">Finished</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="639" x2="752" y1="91.9141" y2="91.9141"/><!--MD5=[4f23141764a98bfe95d928c6b0395753]
class QueryPool--><rect codeLine="61" fill="#FEFECE" filter="url(#f18j3y4y5m4sge)" height="99.2188" id="QueryPool" style="stroke: #A80036; stroke-width: 1.5;" width="238" x="204.5" y="7"/><ellipse cx="288.25" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M290.5938,18.6719 C289.6563,18.2344 289.0625,18.0938 288.1875,18.0938 C285.5625,18.0938 283.5625,20.1719 283.5625,22.8906 L283.5625,24.0156 C283.5625,26.5938 285.6719,28.4844 288.5625,28.4844 C289.7813,28.4844 290.9375,28.1875 291.6875,27.6406 C292.2656,27.2344 292.5938,26.7813 292.5938,26.3906 C292.5938,25.9375 292.2031,25.5469 291.7344,25.5469 C291.5156,25.5469 291.3125,25.625 291.125,25.8125 C290.6719,26.2969 290.6719,26.2969 290.4844,26.3906 C290.0625,26.6563 289.375,26.7813 288.6094,26.7813 C286.5625,26.7813 285.2656,25.6875 285.2656,23.9844 L285.2656,22.8906 C285.2656,21.1094 286.5156,19.7969 288.25,19.7969 C288.8281,19.7969 289.4375,19.9531 289.9063,20.2031 C290.3906,20.4844 290.5625,20.7031 290.6563,21.1094 C290.7188,21.5156 290.75,21.6406 290.8906,21.7656 C291.0313,21.9063 291.2656,22.0156 291.4844,22.0156 C291.75,22.0156 292.0156,21.875 292.1875,21.6563 C292.2969,21.5 292.3281,21.3125 292.3281,20.8906 L292.3281,19.4688 C292.3281,19.0313 292.3125,18.9063 292.2188,18.75 C292.0625,18.4844 291.7813,18.3438 291.4844,18.3438 C291.1875,18.3438 290.9844,18.4375 290.7656,18.75 L290.5938,18.6719 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="62" x="308.75" y="27.1543">QueryPool</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="205.5" x2="441.5" y1="39" y2="39"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="80" x="210.5" y="53.2104">next_id: usize</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="138" x="210.5" y="66.0151">query_timeout: Duration</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="226" x="210.5" y="78.8198">queries: FnvHashMap&lt;QueryId, Query&gt;</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="205.5" x2="441.5" y1="85.4141" y2="85.4141"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="124" x="210.5" y="99.6245">poll(): QueryPoolState</text><!--MD5=[e31fef458fb2d130e0f5f13561a3bb49]
class QueryPoolState--><rect codeLine="70" fill="#FEFECE" filter="url(#f18j3y4y5m4sge)" height="99.2188" id="QueryPoolState" style="stroke: #A80036; stroke-width: 1.5;" width="125" x="478" y="7"/><ellipse cx="493" cy="23" fill="#EB937F" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M491.7969,23.875 L493.25,23.875 L493.25,23.9844 C493.25,24.3906 493.2813,24.5469 493.3594,24.7031 C493.5156,24.9531 493.7969,25.1094 494.0938,25.1094 C494.3438,25.1094 494.6094,24.9688 494.7656,24.75 C494.8906,24.5938 494.9219,24.4375 494.9219,23.9844 L494.9219,22.0625 C494.9219,21.9063 494.9219,21.8594 494.9063,21.7031 C494.8438,21.2344 494.5313,20.9219 494.0781,20.9219 C493.8281,20.9219 493.5625,21.0625 493.3906,21.2813 C493.2813,21.4531 493.25,21.6094 493.25,22.0625 L493.25,22.1875 L491.7969,22.1875 L491.7969,19.7813 L495.7813,19.7813 L495.7813,20.6406 C495.7813,21.0469 495.8125,21.2188 495.8906,21.375 C496.0625,21.625 496.3438,21.7813 496.625,21.7813 C496.8906,21.7813 497.1563,21.6406 497.3281,21.4219 C497.4375,21.25 497.4688,21.1094 497.4688,20.6406 L497.4688,18.0938 L489.8438,18.0938 C489.4063,18.0938 489.2813,18.1094 489.125,18.2031 C488.875,18.3594 488.7188,18.6563 488.7188,18.9375 C488.7188,19.2188 488.8594,19.4688 489.0781,19.6406 C489.2344,19.75 489.4219,19.7813 489.8438,19.7813 L490.0938,19.7813 L490.0938,26.2969 L489.8438,26.2969 C489.4375,26.2969 489.2813,26.3125 489.125,26.4219 C488.875,26.5938 488.7188,26.8594 488.7188,27.1563 C488.7188,27.4219 488.8594,27.6719 489.0781,27.8281 C489.2188,27.9531 489.4531,28 489.8438,28 L497.8438,28 L497.8438,25.4219 C497.8438,24.9844 497.8125,24.8438 497.7344,24.6875 C497.5625,24.4375 497.2813,24.2813 497,24.2813 C496.7344,24.2813 496.4688,24.3906 496.2969,24.6406 C496.1875,24.7969 496.1563,24.9375 496.1563,25.4219 L496.1563,26.2969 L491.7969,26.2969 L491.7969,23.875 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="93" x="507" y="27.1543">QueryPoolState</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="479" x2="602" y1="39" y2="39"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="21" x="484" y="53.2104">Idle</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="42" x="484" y="66.0151">Waiting</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="484" y="78.8198">Finished</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="484" y="91.6245">Timeout</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="479" x2="602" y1="98.2188" y2="98.2188"/><!--MD5=[63abcc6fd3fd37b678d39fd6e8bae488]
reverse link Query to QueryPeerIter--><path codeLine="7" d="M93.5,112.903 C93.5,140.584 93.5,173.295 93.5,197.737 " fill="none" id="Query-backto-QueryPeerIter" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="93.5,99.776,89.5,105.776,93.5,111.776,97.5,105.776,93.5,99.776" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[a84bf2808d96e4396a73ea50742d345c]
link QueryPeerIter to FindNodeQuery--><path codeLine="13" d="M180.129,235 C191.819,235 203.509,235 215.199,235 " fill="none" id="QueryPeerIter-FindNodeQuery" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[e49a15af0d07db42236603a65a0f699a]
reverse link FindNodeQuery to QueryProgress--><path codeLine="26" d="M323.36,316.139 C314.434,334.895 305.273,354.143 297.509,370.457 " fill="none" id="FindNodeQuery-backto-QueryProgress" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="329.023,304.24,322.833,307.9392,323.8669,315.0758,330.0569,311.3766,329.023,304.24" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[2a490d2534c1a0eec4f81f22aece3baf]
link FindNodeQuery to QueryPeer--><path codeLine="27" d="M393.59,304.24 C402.942,324.126 412.966,345.443 421.626,363.857 " fill="none" id="FindNodeQuery-QueryPeer" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[c1127da94d0a8f537821668f8b7a6f16]
reverse link QueryPeer to QueryPeerState--><path codeLine="44" d="M444.5,476.662 C444.5,491.683 444.5,507.732 444.5,522.734 " fill="none" id="QueryPeer-backto-QueryPeerState" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="444.5,463.215,440.5,469.215,444.5,475.215,448.5,469.215,444.5,463.215" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[bdea2ad63438a19ec8aca84c62dcda78]
link QueryPool to QueryPoolState--><path codeLine="68" d="M442.596,56.5 C454.324,56.5 466.052,56.5 477.78,56.5 " fill="none" id="QueryPool-QueryPoolState" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[df556de0543a5156d4ec63567c0d9679]
@startuml
class Query {
	id: QueryId
	peer_iter: QueryPeerIter

	next(): QueryState
}
Query *- - QueryPeerIter

enum QueryPeerIter {
	FindNode ( FindNodeQuery )
	Predicate ( PredicateQuery )
}
QueryPeerIter - FindNodeQuery
'QueryPeerIter - PredicateQuery

class FindNodeQuery {
	target_key: Key
	progress: QueryProgress
	closest_peers: BTreeMap<Distance, QueryPeer>
	iterations: usize
	num_waiting: usize
	config: FindNodeQueryConfig

	next(): QueryState
}
FindNodeQuery o- - QueryProgress
FindNodeQuery - - QueryPeer

'class PredicateQuery {
'}

enum QueryProgress {
	Iterating
	Stalled
	Finished
}

class QueryPeer {
	key: Key
	iteration: usize
	peers_returned: usize
	state: QueryPeerState
}
QueryPeer o- - QueryPeerState

enum QueryPeerState {
	NotContacted
	Waiting
	Unresponsive
	PendingIteration
	Failed
	Succeeded
}

enum QueryState {
	Waiting
	WaitingAtCapacity
	Finished
}

class QueryPool {
	next_id: usize
	query_timeout: Duration
	queries: FnvHashMap<QueryId, Query>

	poll(): QueryPoolState
}
QueryPool - QueryPoolState

enum QueryPoolState {
	Idle
	Waiting
	Finished
	Timeout
}
@enduml

@startuml
class Query {
	id: QueryId
	peer_iter: QueryPeerIter

	next(): QueryState
}
Query *- - QueryPeerIter

enum QueryPeerIter {
	FindNode ( FindNodeQuery )
	Predicate ( PredicateQuery )
}
QueryPeerIter - FindNodeQuery

class FindNodeQuery {
	target_key: Key
	progress: QueryProgress
	closest_peers: BTreeMap<Distance, QueryPeer>
	iterations: usize
	num_waiting: usize
	config: FindNodeQueryConfig

	next(): QueryState
}
FindNodeQuery o- - QueryProgress
FindNodeQuery - - QueryPeer


enum QueryProgress {
	Iterating
	Stalled
	Finished
}

class QueryPeer {
	key: Key
	iteration: usize
	peers_returned: usize
	state: QueryPeerState
}
QueryPeer o- - QueryPeerState

enum QueryPeerState {
	NotContacted
	Waiting
	Unresponsive
	PendingIteration
	Failed
	Succeeded
}

enum QueryState {
	Waiting
	WaitingAtCapacity
	Finished
}

class QueryPool {
	next_id: usize
	query_timeout: Duration
	queries: FnvHashMap<QueryId, Query>

	poll(): QueryPoolState
}
QueryPool - QueryPoolState

enum QueryPoolState {
	Idle
	Waiting
	Finished
	Timeout
}
@enduml

PlantUML version 1.2020.18beta4(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>